<!DOCTYPE html>
<html>

<head>
    <title>Projet 1 WEB</title>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Crimson Text' rel='stylesheet'>
    <link rel="stylesheet" href="style.css">
</head>

<div id="overlay" class="overlay hidden">
    <div class="modal">
        <button class="close-button">&times;</button>
        <div class="modal-content">

            <div class="modal-chart">
                <canvas id="modalCanvas"></canvas>
                <div id="modalMap"></div>
            </div>
            <div id="modalControls" class="modal-controls hidden">
                <div class="modal-text" id="modalText"></div>

                <div id="sliderContainer" class="control-group hidden">
                    <label id="sliderLabel">Multiplicateur : <span id="sliderValue">100%</span></label>
                    <input type="range" id="modalSlider" min="0" max="200" step="1">
                </div>

            </div>
        </div>
    </div>
</div>

<body>
    <header>
        <div id="title">dashboard</div>
        <nav>
            <a href="#page1" class="active">Page 1</a>
            <a href="#page2">Page 2</a>
            <a href="#page3">Page 3</a>
        </nav>
    </header>
    <main>
        <section id="page1" class="dashboard-section">
            <h1 class="section-title">
                Question page1
            </h1>
            <div class="chart-container">

                <div class="chart chart-clickable"
                    data-desc="Ce graphe représente le nombre de personnes décédées ou sorties vivantes des hôpitaux en France, en fonction de leur âge, entre 2020 et 2023. On remarque que plus l’âge des personnes augmente, plus le taux de mortalité augmente lui aussi. Cela peut facilement s’expliquer par le fait que les personnes âgées possèdent une constitution plus faible que les autres.">
                    <h2 class="chart-title">Impact de l'âge sur la mortalité du virus</h2>
                    <canvas id="Chart1_1"></canvas>
                </div>

                <div class="chart chart-clickable" data-desc="Description du graphe 1_2">
                    <h2 class="chart-title">GUH 1_2</h2>
                    <canvas id="Chart1_2"></canvas>
                </div>

            </div>
        </section>

        <section id="page2" class="dashboard-section">
            <h1 class="section-title">
                Question page2
            </h1>

            <div class="chart-container">

                <div class="chart chart-clickable"
                    data-desc="Ce graphe compare l'impact du Covid-19 selon le sexe, en distinguant les décès des survivants. La mortalité est visiblement plus élevée chez les hommes (approchant les 80 000 décès) que chez les femmes. D'après l'Ined, cela pourrait venir d’un plus grand risque pour les hommes d’être contaminés, du fait de leurs comportements – moindre respect des gestes barrière, plus grande interaction sociale, moins de télétravail – et aussi de comorbidités (hypertension, diabète), plus fréquentes chez eux à partir de la cinquantaine.">
                    <h2 class="chart-title">Impact du sexe sur la mortalité du virus</h2>
                    <canvas id="Chart2_1"></canvas>
                </div>

                <div class="chart chart-clickable" data-desc="Description du graphe 2_2">
                    <h2 class="chart-title">GUH 2_2</h2>
                    <canvas id="Chart2_2"></canvas>
                </div>

                <div class="chart chart-clickable" data-desc="Description du graphe 2_3">
                    <h2 class="chart-title map-title">GUH 2_3 map</h2>

                    <div id="Chart2_3"></div>

                </div>
            </div>


        </section>

        <section id="page3" class="dashboard-section">
            <h1 class="section-title">
                test test phrase longue ah ouais c pas ouf là
            </h1>
            <div class="chart-container">

                <div class="chart chart-clickable" data-desc="Description du graphe 3_1">
                    <h2 class="chart-title">GUH 3_1</h2>
                    <canvas id="Chart3_1"></canvas>
                </div>

                <div class="chart chart-clickable" data-desc="Description du graphe 3_2">
                    <h2 class="chart-title">GUH 3_2</h2>
                    <canvas id="Chart3_2"></canvas>
                </div>
                <div class="chart chart-clickable" data-desc="Description du graphe 3_3">
                    <h2 class="chart-title">GUH 3_3</h2>
                    <canvas id="Chart3_3"></canvas>
                </div>

            </div>
        </section>
    </main>
    <script>
        // Update nav links visually based on the section we're at

        // Selecting the objects
        const sections = document.querySelectorAll('.dashboard-section');
        const navLinks = document.querySelectorAll('nav a');

        let activePageIndex = 0;

        const observer = new IntersectionObserver(
            // entries are sections, so basically forEach(section)
            entries => {
                entries.forEach(entry => {
                    // Checks if the section is showed on the screen based on a threshold
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        // Update nav links to toggle the active class
                        navLinks.forEach(link => {
                            link.classList.toggle(
                                'active',
                                link.getAttribute('href') === `#${id}`
                            );
                        });
                        activePageIndex = Array.from(sections).indexOf(entry.target);
                    }
                });
            },
            {
                threshold: 0.6
            }
        );

        sections.forEach(section => observer.observe(section));

        // Allow changing page through scrolling

        let isScrolling = false;

        // Listens for any scrolling event
        window.addEventListener('wheel', (event) => {

            // Returns nothing if we are already scrolling or if an overlay is already active
            const overlayactive = !(document.getElementById('overlay')).classList.contains('hidden')
            if (isScrolling || overlayactive) return;

            if (event.deltaY > 20) {  // deltaY > 0 means we are scrolling downwards, > 20 is just to have a small threshold
                // Increase the page index unless it is already the last one
                if (activePageIndex < sections.length - 1) {
                    activePageIndex++;
                    scrollToSection(activePageIndex);
                }
            } else if (event.deltaY < -20) {
                // Decrease the page index unless it is already the first one
                if (activePageIndex > 0) {
                    activePageIndex--;
                    scrollToSection(activePageIndex);
                }
            }
        });

        // Function : set isScrolling on true, enable the scroll animation, small delay and set isScrolling back on false
        function scrollToSection(index) {
            isScrolling = true;
            sections[index].scrollIntoView({ behavior: 'smooth' });
            setTimeout(() => {
                isScrolling = false;
            }, 400); // delay (ms)
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.anychart.com/releases/8.14.0/js/anychart-core.min.js"></script>
    <script src="https://cdn.anychart.com/releases/8.14.0/js/anychart-map.min.js"></script>
    <script src="https://cdn.anychart.com/geodata/2.2.0/countries/france/france.js"></script>
    <script src="Chart1_1.js"></script>
    <script src="Chart1_2.js"></script>
    <script src="Chart2_1.js"></script>
    <script src="Chart2_2.js"></script>
    <script src="Chart2_3.js"></script>
    <script src="Chart3_1.js"></script>
    <script src="Chart3_2.js"></script>
    <script src="Chart3_3.js"></script>
    <script src="Popup.js"></script>
</body>

</html>